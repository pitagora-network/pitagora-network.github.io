---
title: データ移行手順
permalink: /データ移行手順/
---

[Main Page](/Main_Page "wikilink") &gt;&gt; [Admin](/Admin "wikilink") &gt;&gt;

概要
----

### 移行仕様

-   追加でインストールしたツールは移行されない
-   追加で作成したワークフローは移行されない

### 移行対象

-   仮想ディスク：リファレンス格納用ディスク, データ格納用ディスク
-   MySQLデータベースの移行対象表：dataset\*, galaxy\*, history\*, job

移行手順
--------

### 1. 旧環境でデータベースのデータをエクスポート

1.  phpMyAdmin <http://192.168.56.10/phpmyadmin/> にログインします。
    -   ユーザ名/パスワード -- root/galaxy
2.  データベース「galaxy」を選択します。
3.  「エクスポート」で以下の通り設定して「実行する」でファイルを保存します。
    -   エクスポート方法：詳細
    -   テーブル：dataset\*, galaxy\*, history\*, job\* のみを選択
    -   追加コマンド：DROP TABLE ... を選択

### 2. データ・ファイルの格納ディスクの付け替え（VirtualBox）

1.  旧環境をシャットダウンします。「閉じる」&gt;「ACPIシャットダウン」
2.  OVAファイルから新しいVMをインポートします。
3.  「設定」&gt;「ストレージ」で「Pitagora-Galaxy-x.x.x-disk2/3.vmdk」を除去します。
4.  同じ画面で「ハードディスクの追加」&gt;「既存のディスクを選択」から旧環境の「Pitagora-Galaxy-x.x.x-disk2/3.vmdk」を選択します。
    -   この際、旧環境でスナップショットが作成されている場合にはそれらを削除しディスクを統合しておく必要があります。
    -   旧環境のディスクのコピーを使用する場合には、この手順の前に、「ファイル」&gt;「仮想メディアマネージャー」でコピーを作成しておきます。
5.  新環境を起動します。（この時点では移行が未完了のためジョブを実行しないでください。）

### 2. データ・ファイルの格納ディスクの付け替え（AWS）

1.  旧環境をシャットダウンします。「Instance Management」&gt;「stop」
2.  新しいAMIを起動します。
3.  「Lanch More Like This」 &gt; 「Add Strage」で、以下の２つのストレージを 旧環境の SnapshotID に変更します。
    -   「/dev/xvdb」に igenome の SnapshotID
    -   「/dev/xvdc」に database の SnapshotID
4.  新環境を起動します。（この時点では移行が未完了のためジョブを実行しないでください。）

### 3. 新環境でデータベースのデータをインポート

1.  新環境のphpMyAdmin <http://192.168.56.10/phpmyadmin/> にログインします。
    -   ユーザ名/パスワード -- root/galaxy
2.  データベース「galaxy」を選択します。
3.  「インポート」で旧環境からエクスポートしたファイルを指定して設定変更せずに「実行する」でインポートします。
4.  Galaxy <http://192.168.56.10/phpmyadmin/> にログインし、データが移行できていることを確認します。
